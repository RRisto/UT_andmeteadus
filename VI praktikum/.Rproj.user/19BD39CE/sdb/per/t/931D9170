{
    "contents" : "andmed=read.csv(\"./data/riigikogu_xii.csv\", as.is = TRUE)\n\n#Muuda tunnused numbriliseks. Selleks kodeeri hääletused järgmiselt:\n#vastu tähista arvuga -1, poolt tähista arvuga 1, puudub, erapooletu, ei \n#hääletanud, NA tähista arvuga 0. Pane tähele, et tunnused oleksid numbrilised \n#mitte sõned.\nlibrary(car)\ndata <- apply(andmed, 2, function(x) {x <- recode(x,\"'vastu'=-1; 'poolt'=1; NA=0; \n                                                  'puudub'=0; 'erapooletu'=0;\n                                                  'ei hääletanud'=0\"); x})\n\n#teeme numericuks\ndata_numeric <- apply(data[, 3:1847], 2, function(x) {x <- as.numeric(x); x})\ndata[,3:1847]=data_numeric\n\n#Sorteeri andmestiku read fraktsiooni põhjal ja visualiseeri neid heatmapi abil.\n#Tõlgenda tulemusi.\ndata_order=data[order(data$fraktsioon),]\n\nlibrary(pheatmap)\npheatmap(data_order[, 3:1847], cluster_rows=FALSE, cluster_cols=FALSE)\npheatmap(data_order[, 3:1847], cluster_rows=FALSE, cluster_cols=FALSE, \n         gaps_row = c(24, 68, 73,106))\n\n#Visualiseeri andmestikku heatmapi abil, aga seekord klasterda ka read. Tõlgenda \n#tulemusi.\npheatmap(data_order[, 3:1847], cluster_rows=T, cluster_cols=FALSE)\n\n#Visualiseeri andmestikku heatmapi abil, aga seekord klasterda nii read kui \n#veerud. Tõlgenda tulemusi.\npheatmap(data_order[, 3:1847], cluster_rows=T, cluster_cols=T)\n\n#Riigikogu 2011. aasta valimised võitis Reformierakond ning koalitsioonilepe \n#sõlmiti REF ja IRL vahel. See koalitsioon tegi tööd 3 aastat enne kui purunes. \n#26. märtsil 2014 algas Taavi Rõivase valitsus, kus koalitsioonis olid REF ja SDE.\n#Jaga sisseloetud andmestik data kaheks alamandmestikuks data1 ja data2. Esimene \n#neist sisaldagu hääletusi kuni 2014-03-26. Andmestik data2 sisaldagu hääletusi \n#alates kuupäevast 2014-03-26.\ngrepl(\"2014.03.26\",names(data_order))\ndata1=data_order[, 1:1526]\ndata2=data_order[, c(1,2, 1527:1847)]\n\n\n#Tee PCA esialgsele andmestikule. Visualiseeri kahte esimest peakomponenti \n#hajuvusdiagrammi abil. Tõlgenda tulemusi.\npca_algne=prcomp(data[, -(1:2)])\n\npc1_algne = pca_algne$x[, 1]\npc2_algne = pca_algne$x[, 2]\nplot(pc1_algne, pc2_algne, pch=16, col=as.factor(data$fraktsioon))\ntitle(\"Algne\")\n\nlegend(\"center\",\"groups\", legend = unique(data2$fraktsioon),\n       text.width = 5,cex=0.45, ncol=1,\n       fill = 1:5, bty =\"n\")\n\n#data1\npca_data1=prcomp(data1[, -(1:2)])\n\npc1_data1 = pca_data1$x[, 1]\npc2_data1 = pca_data1$x[, 2]\nplot(pc1_data1, pc2_data1, pch=16, col=as.factor(data1$fraktsioon))\n\nlegend(\"bottom\",\"groups\", legend = unique(data2$fraktsioon),\n       text.width = 5,cex=0.45, ncol=1,\n       fill = 1:5, bty =\"n\")\n\n#data2\npca_data2=prcomp(data2[, -(1:2)])\n\npc1_data2 = pca_data2$x[, 1]\npc2_data2 = pca_data2$x[, 2]\nplot(pc1_data2, pc2_data2, pch=16, col=as.factor(data2$fraktsioon))\n\nlegend(\"bottom\",\"groups\", legend = unique(data2$fraktsioon),\n       text.width = 5,cex=0.45, ncol=1,\n       fill = 1:5, bty =\"n\")\n\n#ühele pildile\npar(mfrow=c(3, 1), mar=c(1, 1, 1, 1) + 0.1)\nplot(pc1_algne, pc2_algne, pch=16, col=as.factor(data$fraktsioon))\ntitle(\"Kogu periood kokku\")\nplot(pc1_data1, pc2_data1, pch=16, col=as.factor(data1$fraktsioon))\ntitle(\"Vana koalitsioon\")\nplot(pc1_data2, pc2_data2, pch=16, col=as.factor(data2$fraktsioon))\ntitle(\"Uus koalitsioon\")\n\nlegend(x = \"bottom\",inset = 0,\n       legend = unique(data2$fraktsioon), \n       fill = 1:5, lwd=1, cex=.7, ncol=1)\n\n# Pärast taasta esialgsed graafilised parameetrid\npar(mfrow=c(1, 1), mar=c(5, 4, 4, 2) + 0.1)\n\n#Eelmises ülesandes rakendasid PCA-d andmestikule data1 ja visualiseerisid \n#seda kasutades kahte esimest komponenti. Kas piisab ka ühest komponendist?\n#ei\nsummary(pca_data1)\n#Visualiseeri data1 esimest peakomonenti selliselt, et näha oleksid ka saadikute\n#nimed. Kas esimest peakomonenti võib tõlgendada kui vasak- ja parempoolsust?\njunn=as.data.frame(pc1_data1)\njunn$nimi=data_order$nimi\njunn$fraktsioon=data_order$fraktsioon\n\nlibrary(ggplot2)\nggplot(junn, aes(x=pc1_data1,  colour=fraktsioon))+\n    geom_point(aes(y=nimi),size=3)+\n    #coord_flip()+\n    facet_wrap(~fraktsioon,scales=\"free_y\")+\n    geom_vline(xintercept=0)+\n    #facet_grid(.~ fraktsioon,  scales=\"free_x\")+\n    theme_minimal()\n\n#XII Riigikogu ajal vahetasid fraktsiooni järgmised saadikud:\n#Aivar Riisalu - Eesti Keskerakonna fraktsioon;Fraktsiooni mittekuuluvad \n#Riigikogu liikmed\n#Andres Herkel - Isamaa ja Res Publica Liidu fraktsioon;Fraktsiooni mittekuuluvad\n#Riigikogu liikmed\n#Deniss Boroditš - Fraktsiooni mittekuuluvad Riigikogu liikmed;Eesti \n#Keskerakonna fraktsioon\n#Inara Luigas - Fraktsiooni mittekuuluvad Riigikogu liikmed;Eesti Keskerakonna \n#fraktsioon;\n#Kalle Laanet - Fraktsiooni mittekuuluvad Riigikogu liikmed;Eesti Keskerakonna \n#fraktsioon;\n#Lembit Kaljuvee - Fraktsiooni mittekuuluvad Riigikogu liikmed;Eesti \n#Keskerakonna fraktsioon;\n#Olga Sõtnik - Eesti Keskerakonna fraktsioon;Fraktsiooni mittekuuluvad \n#Riigikogu liikmed\n#Rainer Vakra - Fraktsiooni mittekuuluvad Riigikogu liikmed;Eesti Keskerakonna \n#fraktsioon\n#(Fraktsioonid ei ole ajalises järjestuses.)\n#Uuri, kuidas muutusid erakonnavahetajate otsused. Kas suudad andmetest \n#tuvastada, millal nad fraktsiooni vahetasid?\nvahet_nimed_kesk=c(\"Aivar Riisalu\", \"Deniss Boroditš\", \n                   \"Inara Luigas\", \"Kalle Laanet\", \n                   \"Lembit Kaljuvee\", \"Olga Sõtnik\",\n                   \"Rainer Vakra\")\nvahetajad_kesk=subset(data, nimi %in% vahet_nimed_kesk\n                      |fraktsioon==\"Eesti Keskerakonna fraktsioon\")\n\npheatmap(vahetajad_kesk[, 3:1847], cluster_rows=FALSE, cluster_cols=FALSE)\n#märgime ära read, kus on vahetajad ning vaatame, kas leiame nad üles\n#st kas muster muutus\ngaps=which(vahetajad_kesk$nimi%in%vahet_nimed_kesk)\n#järjestame ka\nvahetajad_kesk_order=vahetajad_kesk[order(vahetajad_kesk$fraktsioon, \n                                          decreasing = TRUE),]\n#siit on näha, kui keski omad läksid välja 09.04.2012, siis \n#hakkavad eristuma ja ühtselt käituma võrreldes teiste keskidega\npheatmap(vahetajad_kesk_order[, 250:350], cluster_rows=F, cluster_cols=FALSE)\n#vaatan kas paistab silma ka kogu plotilt\npheatmap(vahetajad_kesk_order[, 3:1847], cluster_rows=F, cluster_cols=FALSE)\n\n#paneme ka Riisalu ja Sõtniku, kes pole märgitud mittekeski liiketetena\ngaps=c(7, 20)\npheatmap(vahetajad_kesk_order[, 3:1847], cluster_rows=F, cluster_cols=FALSE, \n         gaps_row=gaps)\n\n\n",
    "created" : 1432364154633.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2623367844",
    "id" : "931D9170",
    "lastKnownWriteTime" : 1432485508,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/Andmeteadus_TU/VI praktikum/riigikogu_praktikum6.R",
    "project_path" : "riigikogu_praktikum6.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}