scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
library(ggplot2)
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~colour)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~color)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali), colour=c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
#     scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
#                                    , "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(x,y,colour=c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
#     scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
#                                    , "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(colour=c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
#     scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
#                                    , "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))
facet_wrap(~partei_luhend)+
theme(legend.position="none")+
geom_point(colour="grey")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")+
geom_point(colour="grey")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(colour="grey")+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
data(mtcars)
cyl6 <- subset(mpg, cyl == 6)
cyl6
p <- ggplot(data = mpg, aes(x=displ, y=hwy))+
geom_point()
p
ggplot(data = mpg, aes(x=displ, y=hwy))+
geom_point()+
facet_wrap(~cyl)
cyl6 <- subset(mpg, cyl == 6)
p <- ggplot(data = mpg, aes(x=displ, y=hwy))+
geom_point()+
facet_wrap(~cyl)
p + geom_point(data = transform(cyl6, cyl = NULL), colour = "red") +
facet_wrap(~ cyl)
transform(cyl6, cyl = NULL)
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(colour="grey")+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")+
geom_point(data = transform(valimised3, partei_luhend = NULL), colour = "red") +
facet_wrap(~ partei_luhend)
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(colour="grey")+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")+
geom_point(data = transform(valimised3, partei_luhend = NULL), colour = "grey") +
facet_wrap(~ partei_luhend)
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(data = transform(valimised3, partei_luhend = NULL),colour="grey")+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(data = transform(valimised3, partei_luhend = NULL),colour="grey")+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")+
theme_bw()
ggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+
scale_y_log10()+
scale_x_log10()+
geom_point(data = transform(valimised3, partei_luhend = NULL),colour="grey")+
geom_point()+
scale_colour_manual(values = c("#00983A", "#FFDE00", "#009FE3"
, "#82368C", "#E30613"))+
facet_wrap(~partei_luhend)+
theme(legend.position="none")
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
library(ggplot2)
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
#teeme sellega ka graafiku
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
#permuteerime vola_skp_suhe väärtuseid
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
plot_permut+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
#jätame ainult vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
andmed=read.csv("./data/skp_ja_volg.csv")
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
plot_permut+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
plot_permut+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
andmed_permut
names(andmed_permut)
plot_permut+stat_smooth(andmed_permut,aes(x=iter1, y=skp_kasv), colour="grey")
plot_permut
plot_permut+stat_smooth(data=andmed_permut,aes(x=iter1, y=skp_kasv), colour="grey")
plot_permut
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
for (i in 1:100) {
j=4
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
andmed_permut
View(andmed_permut)
plot_permut+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
plot_permut
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
plot_permut_iter
for (i in 1:100) {
j=4
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
for (i in 1:100) {
j=4
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
View(andmed_permut_iter)
View(andmed_permut_iter)
for (i in 1:100) {
j=4
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
View(andmed_permut_iter)
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
#permuteerime vola_skp_suhe väärtuseid
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
#jätame ainult vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
#permuteerime vola_skp_suhe väärtuseid
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
#jätame ainult vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
#nüüd tuleb seda 100 korda teha
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
#permuteerime vola_skp_suhe väärtuseid
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
#jätame ainult vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
#nüüd tuleb seda 100 korda teha
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
#permuteerime vola_skp_suhe väärtuseid
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
#jätame ainult vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
#nüüd tuleb seda 100 korda teha
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
#permuteerime vola_skp_suhe väärtuseid
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
#jätame ainult vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
#nüüd tuleb seda 100 korda teha
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
#permuteerime vola_skp_suhe väärtuseid
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
plot_permut=ggplot(andmed_permut, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
#jätame ainult vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv), colour="grey")
#nüüd tuleb seda 100 korda teha
#library(ggplot2) lisaks tuleb esimene graafik valmis teha
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
#jätame alles read, kus pole NAd SKP kasvus ja võla SKP suhtes
andmed_permut=andmed[!is.na(andmed$vola_skp_suhe)&!is.na(andmed$skp_kasv),]
andmed_permut$iter1=sample(andmed_permut$vola_skp_suhe, replace=T)
#jätame vajaliku alles
andmed_permut=andmed_permut[, c("vola_skp_suhe","skp_kasv","iter1" )]
andmed_permut_iter=andmed_permut
#graafik itereerimiseks
plot_permut_iter=ggplot(andmed_permut_iter, aes(x=vola_skp_suhe, y=skp_kasv))+
geom_point()+
stat_smooth()
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=iter1, y=skp_kasv),
colour="grey")
plot_permut_iter
j=4
for (i in 1:100) {
andmed_permut_iter[,j]=sample(andmed_permut_iter$vola_skp_suhe, replace=T)
plot_permut_iter=plot_permut_iter+stat_smooth(aes(x=andmed_permut_iter[,j],
y=skp_kasv), colour="grey")
j+1
}
plot_permut_iter
install.packages("BenfordTest")
maksud=read.csv2("./data/tolliamet_maksud.csv")
maksud$riiklikud_maksud=as.numeric(as.character(maksud$riiklikud_maksud))
maksud$toojoumaksud_ja_maksed=as.numeric(as.character(
maksud$toojoumaksud_ja_maksed))
library(ggplot2)
#maakonna keskmised
library(dplyr)
library(reshape2)
maksud_maakond_group=maksud %>%
group_by(maakond)%>%
summarise(kesk_riiklikud_maksud= mean(riiklikud_maksud, na.rm=T),
mediaan_riiklikud_maksud=median(riiklikud_maksud, na.rm=T),
kesk_tööjõumaksud= mean(toojoumaksud_ja_maksed, na.rm=T),
mediaan_tööjõumaksud=median(toojoumaksud_ja_maksed, na.rm=T))%>%
melt(id.vars="maakond")
ggplot(maksud_maakond_group, aes(x=maakond, y=value))+
geom_point()+
facet_wrap(~variable)+
theme(axis.text.x  = element_text(angle=90, vjust=0.5))
maksud_liik_group=maksud %>%
group_by(liik)%>%
summarise(kesk_riiklikud_maksud= mean(riiklikud_maksud, na.rm=T),
mediaan_riiklikud_maksud=median(riiklikud_maksud, na.rm=T),
kesk_tööjõumaksud= mean(toojoumaksud_ja_maksed, na.rm=T),
mediaan_tööjõumaksud=median(toojoumaksud_ja_maksed, na.rm=T))%>%
melt(id.vars="liik")
ggplot(maksud_liik_group, aes(x=liik, y=value/1000))+
geom_point()+
facet_wrap(~variable)+
theme_minimal()+
theme(axis.text.x  = element_text(angle=90, vjust=0.5))
maksud_sort=maksud%>%
mutate(summa=riiklikud_maksud+toojoumaksud_ja_maksed)%>%
arrange(-summa)
#see on selleks, et ggplot kuvaks maksude järjekorras, mitte tähestikulises
#järjek
maksud_sort$nimi <- as.character(maksud_sort$nimi)
#Then turn it back into an ordered factor
maksud_sort$nimi <- factor(maksud_sort$nimi, levels=unique(maksud_sort$nimi))
ggplot(subset(maksud_sort, liik!="Valitsus- ja riigiasutus")[1:20,],
aes(x=nimi, y=summa/100000))+
geom_bar(stat="identity")+
scale_y_reverse()+
theme(axis.text.x  = element_text(angle=90, vjust=0.5))+
coord_flip()
maksud_sort$esimene_nr_riikl=substr(maksud_sort$riiklikud_maksud, 1, 1)
maksud_sort$esimene_nr_tooj=substr(maksud_sort$toojoumaksud_ja_maksed, 1, 1)
#riiklike maksude osas
library(ggplot2)
kokku_count=nrow(subset(maksud_sort,esimene_nr_riikl!=0))
maksud_sort2=subset(maksud_sort,esimene_nr_riikl!=0)
library(dplyr)
maksud_sort2=maksud_sort2 %>%
group_by(esimene_nr_riikl) %>%
summarise(osakaal=n()/kokku_count)
install.packages("BenfordTests")
summary(maksud)
View(maksud)
View(maksud)
maksud[maksud$registrikood=="10000018",]
maksud[maksud$registrikood=="35403136517",]
maksud[maksud$registrikood=="35605032724",]
summary(maksud$riiklikud_maksud, maksud$maakond)
aggregate(maksud$riiklikud_maksud, maksud$maakond)
library(ggplot2)
ggplot(maksud, aes(x=riiklikud_maksu))+geom_histogram()
ggplot(maksud, aes(x=riiklikud_maksud))+geom_histogram()
ggplot(maksud, aes(x=riiklikud_maksud))+geom_histogram()+geom_bar(data=maksud, aes(x=toojoumaksud_ja_maksed))
data("diamonds")
diamonds
View(diamonds)
