{
    "contents" : "---\ntitle: \"KOV valimised\"\nauthor: \"Risto Hinno\"\ndate: \"Tuesday, May 26, 2015\"\noutput: html_document\n---\n##2013 KOV valimiste hääletustulemuste andmestik\n\nLoe sisse andmestik ja tutvu andmetega. Andmestikus on järgnevad tunnused:\n\n- id: kandidaadi ID\n\n- KOV\n\n- maakond\n\n- nimekiri - partei või valimisliit, kuhu kandidaat kuulub\n\n- partei - kas Keskerakond, Reformierakond, IRL, SDE või Muu\n\n- nr - kandidaadi number\n\n- haali - kandidaadi poolt saadud koguhäälte arv (st paberhääled + ehääled)\n\n- ehaali - kandidaadi poolt saadud e-häälte arv\n\n```{r, cache=TRUE}\nvalimised=read.csv2(\"./data/KOV_valimised_2013.csv\")\n```\n\n##Ülesanne 3 (2 punkti)\n\nTee 3 joonist, mis iseloomustavad hästi seda andmestikku.\n```{r, cache=TRUE, message=FALSE, warning=FALSE}\nlibrary(dplyr)\nlibrary(reshape2)\npartei_group=valimised%>%\n    group_by(partei)%>%\n    summarise(summa_haali=sum(haali),\n              summa_ehaali=sum(ehaali))%>%\n    melt()\n#üldine häälte ja e-jäälte jagunemine parteide vahel\nlibrary(ggplot2)\nggplot(partei_group, aes(x=factor(partei), y=value))+\n    geom_bar(stat = \"identity\")+\n    facet_wrap(~variable)+\n    coord_flip()\n\n##üldine häälte ja e-jäälte jagunemine maakondade vahel\nmaakond_group=valimised%>%\n    group_by(maakond)%>%\n    summarise(summa_haali=sum(haali),\n              summa_ehaali=sum(ehaali))%>%\n    melt()\n\nggplot(maakond_group, aes(x=factor(maakond), y=value))+\n    geom_bar(stat = \"identity\")+\n    facet_wrap(~variable)+\n    coord_flip()\n#e-hääslte ja hääslte arvu vaheline seos\nggplot(valimised, aes(x=haali, y=ehaali))+\n    geom_point()\n\n```\n\n##Ülesanne 4 (2 punkti)\n\nKontrolli visuaalselt Benfordi seaduse kehtimist:\n\n- e-häälte arvul,\n\n- paberhäälte arvul,\n\n- koguhäälte arvul.\n\nSeejärel tee eelnevad joonised ka erakondade kaupa. Kommenteeri tulemusi.\n\n```{r, cache=TRUE, warning=FALSE, message=FALSE}\n#arvutame paberhäälte arvu\nvalimised$paberhaali=valimised$haali-valimised$ehaali\n#lõikame kõigi esimese nri\nvalimised$haali_esim_nr=substr(valimised$haali, 1, 1)\nvalimised$ehaali_esim_nr=substr(valimised$ehaali, 1, 1)\nvalimised$paberhaali_esim_nr=substr(valimised$paberhaali, 1, 1)\n\n#teeme benfordi jaotusele vastava jaotuse\nlibrary(BenfordTests)\nbenford=as.data.frame(pbenf(digits = 1))\n#arvutame iga esinumbri counti\nlibrary(reshape2)\nvalimised2=melt(valimised[, c(\"partei\",\"haali_esim_nr\", \"ehaali_esim_nr\", \n                              \"paberhaali_esim_nr\")],id=c(\"partei\"))\nvalimised2=subset(valimised2, value!=0)\n#arvutame iga grupi (hääle liigi) counti, iga hääli liigi iga esimese nr counti\n#ja iga esinumbri osakaalu hääle liigis\nlibrary(dplyr)\nvalimised_liik=valimised2 %>%\n    group_by(variable) %>%\n    mutate(kokku=n()) %>%\n    group_by(variable, value) %>%\n    mutate(kokku_grupp=n(),\n              osakaal=kokku_grupp/kokku)\n#teeme ploti\nggplot(valimised_liik,aes(x=factor(value), y=osakaal, group=1))+\n    geom_point()+\n    geom_line()+\n    geom_line(data=benford, aes(x=Var1, y=Freq,group=1), colour=\"red\")+\n    facet_wrap(~variable)\n\n#teeme sama asja erakondade kaupa\nvalimised_liik_partei=valimised2 %>%\n    group_by(partei, variable) %>%\n    mutate(kokku=n()) %>%\n    group_by(partei, variable, value) %>%\n    mutate(kokku_grupp=n(),\n           osakaal=kokku_grupp/kokku)\n#teeme ploti\nggplot(valimised_liik_partei,aes(x=factor(value), y=osakaal, group=variable, \n                                 colour=variable))+\n    geom_point()+\n    geom_line()+\n    geom_line(data=benford, aes(x=Var1, y=Freq,group=1), colour=\"black\")+\n    facet_wrap(~partei)\n\n```\n\nTeen plotid, mis on sarnased näidatule\n\n```{r, cache=TRUE, warning=FALSE, message=FALSE}\nlibrary(dplyr)\nvalimised3=valimised %>%\n    mutate(partei_luhend=factor(partei, \n                                labels = c(\"KESK\", \"REF\", \"IRL\", \"Muu\", \"SDE\")))\n\nggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+\n    scale_y_log10()+\n    scale_x_log10()+\n    geom_point()+\n     scale_colour_manual(values = c(\"#00983A\", \"#FFDE00\", \"#009FE3\"\n                                         , \"#82368C\", \"#E30613\"))+\n    facet_wrap(~partei_luhend)+\n    theme(legend.position=\"none\")\n\n#üritame teha nii, ert igal facetil on kõik punktid, kuid ainult \n#vastava erakonna oma on värviline\nggplot(valimised3, aes(x=haali, y=ehaali, colour=partei_luhend))+\n    scale_y_log10()+\n    scale_x_log10()+\n    geom_point(data = transform(valimised3, partei_luhend = NULL),colour=\"grey\")+\n    geom_point()+\n    scale_colour_manual(values = c(\"#00983A\", \"#FFDE00\", \"#009FE3\"\n                                   , \"#82368C\", \"#E30613\"))+\n    facet_wrap(~partei_luhend)+\n    theme(legend.position=\"none\")\n\n```\n\n",
    "created" : 1432664533802.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3207686512",
    "id" : "E1A658EA",
    "lastKnownWriteTime" : 1432923334,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/Andmeteadus_TU/II praktikum/praktikum2_KOV_valimised.Rmd",
    "project_path" : "praktikum2_KOV_valimised.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}