geom_histogram(aes(y=..density..), binwidth=0.1, fill="white" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
coord_cartesian(xlim=c(0, 2.5))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.1, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
coord_cartesian(xlim=c(0, 2.5))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.1, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1))+
coord_cartesian(xlim=c(0, 2.5))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.1, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 2.5))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.1, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 2))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.1, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.7))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.1, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.8))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.09, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.8))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.01, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.8))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.05, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.8))
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.8))
qqnorm(kit1_caucasian)
kit1_caucasian
qqnorm(kit1_caucasian$ratio)
qqplot(kit1_caucasian$ratio)
qqpline(kit1_caucasian$ratio)
qqline(kit1_caucasian$ratio)
ks.test(kit1_caucasian$ratio)
ks.test(kit1_caucasian$ratio,"pgamma")
ks.test(kit1_caucasian$ratio,"pgamma", shape=shape1, rate=rate1)
ks.test(kit1_caucasian$ratio,"dlnorm", meanlog=meanlog1, sdlog=sdlog1)
2.2e-16
value(2.2e-16)
2.2e-16*1000
format(2.2e-13,scientific=FALSE)
ks.test(kit1_caucasian$ratio,"dlnorm", meanlog=meanlog1, sdlog=sdlog1, alternative="less")
kit2_caucasian=doping_subset[c(doping_subset$kit==2&doping_subset$ethnicity=="caucasian"),]
kit1_african=doping_subset[c(doping_subset$kit==1&doping_subset$ethnicity=="african"),]
kit2_african=doping_subset[c(doping_subset$kit==2&doping_subset$ethnicity=="african"),]
log_norm_param2=fitdistr(x=kit2_caucasian$ratio, densfun="log-normal")
meanlog2=log_norm_param2$estimate[1]
sdlog2=log_norm_param2$estimate[2]
meanlog2
qlnorm(0.9999, meanlog = meanlog2, sdlog = sdlog2)
log_norm_param3=fitdistr(x=kit1_african$ratio, densfun="log-normal")
meanlog3=log_norm_param3$estimate[1]
sdlog3=log_norm_param3$estimate[2]
qlnorm(0.9999, meanlog = meanlog3, sdlog = sdlog3)
log_norm_param4=fitdistr(x=kit2_african$ratio, densfun="log-normal")
meanlog4=log_norm_param4$estimate[1]
sdlog4=log_norm_param4$estimate[2]
qlnorm(0.9999, meanlog = meanlog4, sdlog = sdlog4)
qlnorm(0.9999, meanlog = meanlog, sdlog = sdlog)
qlnorm(0.9999, meanlog = meanlog2, sdlog = sdlog2)
qlnorm(0.9999, meanlog = meanlog, sdlog = sdlog)
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.8))
kit1=doping_subset[c(doping_subset$kit==1),]
kit1=doping_subset[c(doping_subset$kit==1),]
log_norm_param5=fitdistr(x=kit21$ratio, densfun="log-normal")
meanlog5=log_norm_param5$estimate[1]
sdlog5=log_norm_param5$estimate[2]
qlnorm(0.9999, meanlog = meanlog5, sdlog = sdlog5)
kit1=doping_subset[c(doping_subset$kit==1),]
log_norm_param5=fitdistr(x=kit1$ratio, densfun="log-normal")
meanlog5=log_norm_param5$estimate[1]
sdlog5=log_norm_param5$estimate[2]
qlnorm(0.9999, meanlog = meanlog5, sdlog = sdlog5)
kit2=doping_subset[c(doping_subset$kit==2),]
log_norm_param6=fitdistr(x=kit2$ratio, densfun="log-normal")
meanlog6=log_norm_param6$estimate[1]
sdlog6=log_norm_param6$estimate[2]
qlnorm(0.9999, meanlog = meanlog6, sdlog = sdlog6)
verification=read.csv("./data/doping_verification.csv.")
View(verification)
verification$ratio=verification$rec/verification$pit
View(verification)
verif_subset=subset(verification, rec=>0.01 & pit=>0.05)
verif_subset=subset(verification, rec>=0.01 & pit>=0.05)
verif_subset=subset(verification, rec>=0.01 |pit>=0.05)
verif_subset=subset(verification, rec>=0.01 & pit>=0.05)
verification$ratio=verification$rec/verification$pit
verif_subset=subset(verification, rec>=0.01 & pit>=0.05)
param_verif=fitdistr(x=verif_subset$ratio, densfun="log-normal")
meanlog_verif=param_verif$estimate[1]
sdlog_verif=param_verif$estimate[2]
ks.test(verif_subset$ratio,"dlnorm", meanlog=meanlog_verif, sdlog=sdlog_verif)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="black" )+
geom_histogram(aes(data=verif_subset, y=..density..), binwidth=0.06, fill="white", colour="black" )
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="black" )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="white", colour="black" )
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue" )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey" )
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue" )
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.5 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.5)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
verification$ratio=verification$rec/verification$pit
param_verif=fitdistr(x=verification$ratio, densfun="log-normal")
meanlog_verif1=verification$estimate[1]
sdlog_verif1=verification$estimate[2]
#viskame välja sodi
verif_subset=subset(verification, rec>=0.01 & pit>=0.05)
param_verif=fitdistr(x=verif_subset$ratio, densfun="log-normal")
meanlog_verif1=param_verif$estimate[1]
sdlog_verif1=param_verif$estimate[2]
verification$ratio=verification$rec/verification$pit
param_verif1=fitdistr(x=verification$ratio, densfun="log-normal")
meanlog_verif1=param_verif1$estimate[1]
sdlog_verif1=param_verif1$estimate[2]
#viskame välja sodi
verif_subset=subset(verification, rec>=0.01 & pit>=0.05)
param_verif2=fitdistr(x=verif_subset$ratio, densfun="log-normal")
meanlog_verif2=param_verif2$estimate[1]
sdlog_verif2=param_verif2$estimate[2]
ks.test(verif_subset$ratio,"dlnorm", meanlog=meanlog_verif2, sdlog=sdlog_verif2)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1), colour="blue")
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
#stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))
sdlog_verif2
meanlog_verif2
class(meanlog_verif2)
qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1)
qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2)
meanlog_verif2
meanlog_verif1
param_verif2
meanlog_verif1
param_verif1
param_verif1=fitdistr(x=verification$ratio, densfun="log-normal")
verification$ratio=verification$rec/verification$pit
param_verif1=fitdistr(x=verification$ratio, densfun="log-normal")
verification$ratio
param_verif1=fitdistr(x=verification$ratio, densfun="log-normal", na.rm=T)
param_verif1=fitdistr(x=!is.infinite(verification$ratio), densfun="log-normal", na.rm=T)
!is.infinite(verification$ratio)
param_verif1=fitdistr(x=verification$ratio[!is.infinite(verification$ratio)], densfun="log-normal", na.rm=T)
verification$ratio[!is.infinite(verification$ratio)]
param_verif1=fitdistr(x=verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)], densfun="log-normal")
verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)]
proov=verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)]
min(proov)
x=verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)]
x
hist(x)
x<1
x<0
subset(verification, ratio<0)
verification[4090:4099,]
x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)]=>0)
x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)]&ratio=>0)
x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)&ratio=>0)]
x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)&verification$ratio=>0)]
x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)&verification$ratio>=0)]
x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)&verification$ratio>=0])
x
param_verif1=fitdistr(x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)&verification$ratio>=0]), densfun="log-normal")
library(MASS)
param_verif1=fitdistr(x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)&verification$ratio>=0]), densfun="log-normal")
param_verif1=fitdistr(x=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)&verification$ratio>0]), densfun="log-normal")
meanlog_verif1=param_verif1$estimate[1]
sdlog_verif1=param_verif1$estimate[2]
verif_subset=subset(verification, rec>=0.01 & pit>=0.05)
param_verif2=fitdistr(x=verif_subset$ratio, densfun="log-normal")
meanlog_verif2=param_verif2$estimate[1]
sdlog_verif2=param_verif2$estimate[2]
ks.test(verif_subset$ratio,"dlnorm", meanlog=meanlog_verif2, sdlog=sdlog_verif2)
ks.test(kit1_caucasian$ratio,"pgamma", shape=shape1, rate=rate1)
ks.test(kit1_caucasian$ratio,"dlnorm", meanlog=meanlog1, sdlog=sdlog1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
#stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
coord_cartesian(xlim=c(0, 1.8))
library(ggplot2)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
#stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
coord_cartesian(xlim=c(0, 1.8))
meanlog_verif2
sdlog_verif2
qlnorm(0.9999, meanlog = meanlog6, sdlog = sdlog6)
x1=qlnorm(0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
#stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
#geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1))+
geom_vline(xintercept=x1)
x1
class(x1)
ggplot(kit1_caucasian, aes(x=ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="white", colour="black" )+
stat_function(fun=dlnorm, args = list(meanlog=meanlog1, sdlog=sdlog1))+
stat_function(fun=dgamma, args=list(shape=shape1, rate=rate1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))+
geom_vline(xintercept=qgamma(p=0.9999, shape = shape1, rate = rate1), colour="blue")+
coord_cartesian(xlim=c(0, 1.8))
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
#stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
#geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog1, sdlog = sdlog1))
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1))+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)+
coord_cartesian(xlim=c(0, 1.8))
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)+
coord_cartesian(xlim=c(0, 2))
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)+
coord_cartesian(xlim=c(0, 10))
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)+
coord_cartesian(xlim=c(0, 5))
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
coord_cartesian(xlim=c(0, 5))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
#coord_cartesian(xlim=c(0, 5))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1))+
coord_cartesian(xlim=c(0, 5))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1), colour="blue")+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif2, sdlog=sdlog_verif2))+
coord_cartesian(xlim=c(0, 5))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
#geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
geom_density()+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1), colour="blue")+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif2, sdlog=sdlog_verif2))+
coord_cartesian(xlim=c(0, 5))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
#geom_density()+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1), colour="blue")+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif2, sdlog=sdlog_verif2))+
coord_cartesian(xlim=c(0, 5))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.06, fill="blue", colour="blue", alpha=0.1 )+
#geom_density()+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1), colour="blue")+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif2, sdlog=sdlog_verif2))+
coord_cartesian(xlim=c(0, 3))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.06, fill="grey", colour="grey", alpha=0.1)
ggplot(verification, aes(ratio))+
geom_histogram(aes(y=..density..), binwidth=0.01, fill="blue", colour="blue", alpha=0.1 )+
#geom_density()+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif1, sdlog = sdlog_verif1), colour="blue")+
geom_vline(xintercept=qlnorm(p=0.9999, meanlog = meanlog_verif2, sdlog = sdlog_verif2))+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif1, sdlog=sdlog_verif1), colour="blue")+
stat_function(fun=dlnorm, args = list(meanlog=meanlog_verif2, sdlog=sdlog_verif2))+
coord_cartesian(xlim=c(0, 3))+
geom_histogram(data=verif_subset,aes(y=..density..), binwidth=0.01, fill="grey", colour="grey", alpha=0.1)
piir=list()
proov=sample(verif_subset$ratio)
for (i in 1:100) {
param=fitdistr(x=sample(verif_subset$ratio, replace=T), densfun="log-normal")
meanlog=param$estimate[1]
sdlog=param$estimate[2]
piir[i]=qlnorm(0.9999, meanlog = meanlog, sdlog = sdlog)
}
piir
piir=list()
for (i in 1:10000) {
param=fitdistr(x=sample(verif_subset$ratio, replace=T), densfun="log-normal")
meanlog=param$estimate[1]
sdlog=param$estimate[2]
piir[i]=qlnorm(0.9999, meanlog = meanlog, sdlog = sdlog)
}
hist(piir)
class(piir)
piir=numeric()
for (i in 1:10000) {
param=fitdistr(x=sample(verif_subset$ratio, replace=T), densfun="log-normal")
meanlog=param$estimate[1]
sdlog=param$estimate[2]
piir[i]=qlnorm(0.9999, meanlog = meanlog, sdlog = sdlog)
}
hist(piir)
library(boot'')
library(boot)
boot.ci(piir)
boot.ci(data.frame(piir))
data.frame(piir)
ks.test(kit1_caucasian$ratio,"pgamma", shape=shape1, rate=rate1)
names(data.frame(piir))
boot.ci(data.frame(piir$piir))
keskmine=mean(piir)
keskmine
summary(piir)
quantile(piir, c(.05, .5, .95))
se=sd(piir)/sqrt(length(piir))
keskmine+c(-1,1)*1.65*se
quantile(piir, c(.05, .5, .95))
se
10000*0.02
200*0.25
9800*0.999
9800*0.9999
50/10
1/5
1/50
50/60
50/51
library(ggplot2)
ggplot(verification, aes(x=rec, y=ratio))+
geom_point()
ggplot(verification, aes(x=pit, y=ratio))+
geom_point()
ggplot(verification, aes(x=pit+rec, y=ratio))+
geom_point()
ggplot(doping, aes(x=rec, y=ratio))+
geom_point()
ggplot(doping, aes(x=pit, y=ratio))+
geom_point()
ggplot(doping, aes(x=pit+rec, y=ratio))+
geom_point()
cor(verification)
cor(verification[,4:7])
cor(c(verification$pit, verification$ratio))
cor(c(numeric(verification$pit), numeric(verification$ratio)))
cor.test(c(numeric(verification$pit), numeric(verification$ratio)))
class(verification$pit)
cor.test(verification$pit, verification$ratio)
cor(verification$pit, verification$ratio)
cor(verification$pit, verification$ratio, na.rm=T)
cor(verification$pit, verification$ratio, rm.na=T)
unique(verification$pit)
verification_puhas=verification[complete.cases(verification[,4:7]),]
cor(verification_puhas$pit, verification_puhas$ratio)
verification_puhas
unique(verification_puhas$pit)
cor(verification_puhas$pit, verification_puhas$ratio)
verification_puhas=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)])
cor(verification_puhas$pit, verification_puhas$ratio)
verification_puhas=data.frame(verification_puhas)
cor(verification_puhas$pit, verification_puhas$ratio)
View(verification_puhas)
verification_puhas=(verification$ratio[!is.infinite(verification$ratio)&!is.na(verification$ratio)])
verification_puhas=(verification[!is.infinite(verification$ratio)&!is.na(verification$ratio)])
verification_puhas=verification[!is.infinite(verification$ratio)&!is.na(verification$ratio),]
cor(verification_puhas$pit, verification_puhas$ratio)
doping_puhas=doping[!is.infinite(doping$ratio)&!is.na(doping$ratio),]
cor(doping_puhas$pit, doping_puhas$ratio)
qqnorm(kit1_caucasian$ratio)
qqline(kit1_caucasian$ratio)
qqline(kit1_caucasian$ratio)
qqline(kit1_caucasian$ratio)
hist(piir)
abline(v=2)
abline(v=2, colour="blue")
abline(v=2, col="blue")
abline(v=2)
abline(h=2)
hist(piir)
plot(c(-2,3), c(-1,5), type = "n", xlab = "x", ylab = "y", asp = 1)
## the x- and y-axis, and an integer grid
abline(h = 0, v = 0, col = "gray60")
hist(piir)
abline(v = 2.3, col = "gray60")
quantile(piir, c(.05, .5, .95))
quantile(piir, c(.025, .5, .975))
attributes(quantile(piir, c(.025, .5, .975)))
quantile(piir, c(.025, .5, .975))$names[1]
quantile(piir, c(.025, .5, .975))$names
quantile(piir, c(.025, .5, .975))[1]
tabel=read.csv("./data/tundlikkus, septiif,csv")
tabel=read.csv("./data/tundlikkus.csv")
View(tabel)
tabel=read.csv("./data/tundlikkus.csv")
View(tabel)
