{
    "contents" : "#Laadi ÕISist alla andmestik UT_13_14_hinded.csv. Selles andmestikus on \n#2013/2014 õppeaasta kõigi TÜ õppeainete kohta, mis olid eristava hindamisega, \n#toodud üliõpilaste õppetulemuste jaotus. Lisaks on teada\n#semester (sügis/kevad), teaduskond (TÜ struktuuriüksuse lühend),\n#AR Arstiteaduskond, EC Euroopa kolledž,FL Filosoofiateaduskond\n#KK Kehakultuuriteaduskond, LO Loodus- ja tehnoloogiateaduskond\n#MJ Majandusteaduskond, MT Matemaatika-informaatikateaduskond\n#NC Narva kolledž, OI Õigusteaduskond,OO Õppeosakond,PC Pärnu kolledž\n#SH Sotsiaal- ja haridusteaduskond, US Usuteaduskond, VK Viljandi \n#kultuuriakadeemia, aine kood,aine nimi, ainele registreerunud üliõpilaste arv,\n#õppeainele registreerunud üliõpilaste õppetulemuste (A, B, C, D, E, F, \n#mitte ilmunud) jaotus\n\nhinded=read.csv2(\"./data/UT_13_14_hinded.csv\")\n\n#Ülesanne 1 (4 punkti)\n#Kas mõnes teaduskonnas saavad üliõpilased paremaid hindeid kui mõnes teises? \n#Kuidas seda visuaalselt kontrollida? Tee seda.\n\nlibrary(dplyr)\nhinded2=mutate(hinded,\n       keskmine = (A*5+B*4+C*3+D*2+E*1)/(registreerunuid-mi))\n#osades on hindeid saanud rohkem kui ainele reganud, eemaldan need vaatlused\nhinded2_sub=subset(hinded2, keskmine<=5& keskmine>=0)\n#leiame järjekorra, keskmiste kaupa\nhinded2_order=with(hinded2_sub, reorder(teaduskond,keskmine, median))\n\n#teeme ploti\nlibrary(ggplot2)\nggplot(hinded2_sub, aes(x=hinded2_order, y=keskmine))+\n    geom_boxplot(aes(fill=teaduskond))+\n    geom_jitter()+\n    xlab(\"teaduskond\")+\n    ylab(\"keskmine hinne\")\n\n#teise ploti jaoks teeme andmed lühikeseks\nlibrary(reshape2)\nhinded2$mi=NULL\nhinded2_melt=melt(hinded2, measure.vars = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"))\n\nnames(hinded2_melt)[7:8]=c(\"hinne\", \"opilaste_arv\")\n\n#leiame järjekorra, keskmiste kaupa\nhinded2_melt_order=with(hinded2_melt, reorder(teaduskond,keskmine, median))\n\n#leiame õige teaduskonna järjestuse keskmise hinde järgi\nlevelid=levels(hinded2_melt_order)\nhinded2_melt2=hinded2_melt\n#paneme selle  tabelisse nii, et graafikul kuvaks õiges järjekorras\nhinded2_melt2$teaduskond <- factor(hinded2_melt2$teaduskond, levels = levelid)\n#teeme ploti\nggplot(hinded2_melt2, aes(x=hinne, y=opilaste_arv, fill=teaduskond))+\n    geom_bar(stat=\"identity\")+\n    facet_wrap(~teaduskond, scales = \"free\")\n\n#teeme kolmanda ploti\nggplot(hinded2_melt, aes(x=hinded2_melt_order, y=opilaste_arv,fill=hinne))+\n    geom_bar(position=\"fill\", stat=\"identity\")+\n    scale_fill_brewer()\n   \n\n#Ülesanne 2 (4 punkti)\n#Kas mõnes õppeaines saavad üliõpilased paremaid hindeid kui mõnes teises? \n#Millistes ainetes täpsemalt? Visualiseeri. Juhised:\n#Vali välja sobiv joonisetüüp. Selleks võid kasutada mõnda eelmises ülesandes \n#välja pakutud lahendust või pakkuda välja enda variandi. (Näiteks võid teha \n#analoogilise joonise nagu ülesande 1 kolmas joonis, ainult et teaduskondade \n#rollis oleksid õppeained. Samas võid ka teha näiteks tulpdiagrammi, mis näitaks \n#iga õppeaine keskmist hinnet.).Vaatle väiksemat andmestikku, kus teaduskond ja \n#semester oleksid fikseeritud. Näiteks võid valida matemaatika-\n#informaatikateaduskonna ning kevadsemestri.(Järgmises ülesandes tuleb koodi \n#natuke modifitseerida, et rakenduse kasutaja saaks ise valida teda huvitava \n#teaduskonna ja semestri.) Vaatle ainult selliseid aineid, kus oli vähemalt 5 \n#registreerunut. Leia iga õppeaine keskmine hinne.Järjesta õppeained keskmise \n#hinde põhjal. Vali visualiseerimiseks välja TOP 25 ained.Praegu on õppeaine nimi \n#selline faktor, mille tasemed on tähestikulises järjekorras. Aga ggplot2 joonise \n#jaoks oleks hea, kui see oleks järjestatud keskmise hinde põhjal. (Näpunäide: \n#kasuta funktsiooni reorder.)\n#Tee joonis. Juhul, kui kasutad mõnda tulpdiagrammi, võib horisontaalne esitus \n#osutuda efektiivsemaks kui vertikaalne. Abiks on coord_flip(). Kirjuta eelnev \n#kood funktsiooniks, mille sisendiks sobiks selline andmestik nagu oli failis \n#UT_13_14_hinded.csv. Lisaks oleks sisendiks teaduskond ja semester. \n#Funktsioon peab tagastama ggplot2 joonise. Kontrolli, kas funktsioon töötab.\n\ndata=hinded\nsem=c(\"K\")\nteaduskond1=c(\"MT\")\n\n#teeme subseti andmetest\ndata_subset=subset(data, teaduskond==teaduskond1 & semester==sem)\nlibrary(dplyr)\ndata_subset=mutate(data_subset,\n               keskmine = (A*5+B*4+C*3+D*2+E*1)/(registreerunuid-mi))\n#osades on hindeid saanud rohkem kui ainele reganud, eemaldan need vaatlused\ndata_subset=subset(data_subset, keskmine<=5& keskmine>=0)\n#hoiame alles 25 ainet\ndata_subset=data_subset[1:25,]\n#leiame ainete järjekorra, keskmiste kaupa\ndata_sub_order=with(data_subset, reorder(aine,keskmine, median))\n\n#teeme ploti\nlibrary(ggplot2)\nggplot(data_subset, aes(y=keskmine, x=data_sub_order))+\n    geom_bar(stat=\"identity\", fill=\"#56B4E9\")+\n    coord_flip()\n\n#sama asi funktsioonina\nplot_oppeained = function(data, tk, sem){\n    library(dplyr)\n    data_subset=data %>%\n        subset(teaduskond==tk & semester==sem) %>%\n        mutate(keskmine = (A*5+B*4+C*3+D*2+E*1)/(registreerunuid-mi)) %>%\n        subset(keskmine<=5& keskmine>=0)\n    #hoimae ianult 25 rida alles\n    data_subset=data_subset[1:25,]\n    #teeme kitsaks andmetabeli\n    library(reshape2)\n    data_subset$mi=NULL\n    data_subset_melt=melt(data_subset, \n                          measure.vars = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"))\n    names(data_subset_melt)[7:8]=c(\"hinne\", \"opilaste_arv\")\n    #teeme ploti  \n    library(ggplot2)\n    ggplot(data_subset_melt, aes(x=reorder(aine,keskmine, median), \n                                 y=opilaste_arv,fill=hinne))+\n        geom_bar(position=\"fill\", stat=\"identity\")+\n        scale_fill_brewer()+\n        xlab(\"\")+\n        ylab(\"\")+\n        coord_flip()\n}\n\n\nplot_oppeained(data=hinded, tk=\"AR\", sem=\"K\")\nplot_oppeained(data=hinded, tk=\"MT\", sem=\"K\")\nplot_oppeained(data=hinded, tk=\"OI\", sem=\"K\")\n\n\n#Boonusülesanne 2: Kuidas optimeerida õppeaine tagasisidet?\n#Õppejõud Peeter “Bijektsioon” Ratsionaalil kästi õppeaine ümber korraldada. \n#Tema õpetatavate ainete tagasiside on siiani olnud kehv, kuid ta on veendunud, \n#et see pole mitte viletsa õpetamise ja halva ainekorralduse tõttu, vaid et \n#üliõpilased annavadki paremat tagasisidet sellistele ainetele, kus eriti midagi \n#tegema ei pea ning kus saab vähese vaevaga häid hindeid.\n#Uuri, kas Peetri väited peavad paika. See tähendab, et kas tõepoolest on tal \n#lootust saada ainele paremat tagasisidet, kui selle töömaht on väiksem, kui \n#ette nähtud, ning kui tudengitele panna paremaid hindeid.\n#Laadi ÕISist alla andmestik UT_13_14_tagasiside.csv. (Praktikumis kasutatud \n#andmestik oli selle alamandmestik.) Siin on toodud 2013/2014 õppeaasta kõigi \n#TÜ õppeainete kohta (st nii eristava kui ka mitteeristava hindamisega):\n#semester (sügis/kevad), teaduskond (TÜ struktuuriüksuse lühend, samasugused, \n#nagu praktikumis kasutatud andmestikus), aine kood, aine nimi, ainele \n#registreerunud üliõpilaste arv, õppeaine töömahtu puudutava tagasiside küsimuse\n#vastuste jaotus\n#tagasiside_1 - aine töömaht oli tunduvalt väiksem\n#tagasiside_2 - aine töömaht oli mõnevõrra väiksem\n#tagasiside_3 - aine töömaht oli selline, nagu ette nähtud\n#tagasiside_4 - aine töömaht oli mõnevõrra suurem\n#tagasiside_5 - aine töömaht oli tunduvalt suurem\n#tagasiside küsimuse “Kokkuvõttes hindan antud õppeainet hindega” tulemuste \n#jaotus\n#veerud tagasiside_A, …, tagasiside_F\n#õppeainele registreerunud üliõpilaste õppetulemuste jaotus\n#eristava hindamisega ainete jaoks veerud hinne_A, …, hinne_mi\n#mitteeristava hindamisega ainete jaoks veerud hinne_arv, hinne_marv, hinne_mi\n#Ülesanded:    \n#(3 boonuspunkti) Uuri, kas õppeaine tagasiside skoor üleüldse sõltub aine \n#töömahust, ning kas ette nähtust väiksem töömaht tagab ainele parema tagasiside.\n#Visualiseeri.\n#(3 boonuspunkti) Uuri, kas õppeainele antud tagasiside üleüldse sõltub \n#tudengite õppetulemustest seal aines, ning milline see sõltuvus on. \n#Visualiseeri.\n\ntagasiside=read.csv2(\"./data/UT_13_14_tagasiside.csv\")\n#tagasiside$hinne_arv=NULL\n#tagasiside$hinne_marv=NULL\n#tagasiside$hinne_mi=NULL\ntagasiside=tagasiside %>%\n    mutate(keskmine_hinne = (hinne_A*5+hinne_B*4+hinne_C*3+hinne_D*2+hinne_E*1+\n                                 hinne_F*0)/\n               (hinne_A+hinne_B+hinne_C+hinne_D+hinne_E))%>%\n    mutate(keskmine_toomaht = (toomaht_1*1+toomaht_2*2+toomaht_3*3+toomaht_4*4+\n                                   toomaht_5*5)/\n               (toomaht_1+toomaht_2+toomaht_3+toomaht_4+\n                     toomaht_5))%>%\n    mutate(keskmine_tagasiside = (tagasiside_A*5+tagasiside_B*4+tagasiside_C*3+\n                                      tagasiside_D*2+tagasiside_E*1+\n                                      tagasiside_F*0)/\n               (tagasiside_A+tagasiside_B+tagasiside_C+\n                    tagasiside_D+tagasiside_E+\n                    tagasiside_F))\n \n#jätame ainult arvestusega ained\narvestused=subset(tagasiside, hinne_arv|hinne_marv!=0)\n\n#vasatame, kas on seos keskmise hinde ja töömahu vahel\nlibrary(ggplot2)\n\n#seos keskmise tagasiside ja töömaht\nggplot(tagasiside, aes(x=keskmine_toomaht, y=keskmine_tagasiside))+\n    geom_point()+\n    geom_smooth()\n\nggplot(tagasiside, aes(x=keskmine_hinne, y=keskmine_toomaht))+\n    geom_point()+\n    geom_smooth()\n\n#kas ette nähtust väiksem töömaht tagab ainele parema tagasiside\nggplot(subset(tagasiside, keskmine_toomaht<=3), aes(x=keskmine_hinne, \n                                                    y=keskmine_toomaht))+\n    geom_point()+\n    geom_smooth()\n\n\n#kas tagasiside sõltub hindest\nggplot(tagasiside, aes(x=keskmine_hinne, y=keskmine_tagasiside))+\n    geom_point()+\n    geom_smooth(method=\"lm\")\n\n#teeme regressioonimudeli\nregressioon=lm(data=tagasiside, keskmine_hinne ~ keskmine_tagasiside)\nsummary(regressioon)\n\n\n\n\n",
    "created" : 1433176498485.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "957474462",
    "id" : "425E3E6",
    "lastKnownWriteTime" : 1433613004,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/Andmeteadus_TU/III praktikum/praktikum3_oppeained.R",
    "project_path" : "praktikum3_oppeained.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}