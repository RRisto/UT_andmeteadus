{
    "contents" : "andmed=read.csv2(\"aktsiad.csv\", sep=\";\")\n\n#Kõigepealt leia kolm kõige suurema päevase tootlusega aktsiat ning väljasta nende kohta:\n#ettevõtte sümbol, ettevõtte nimi, tootlus.\nlibrary(dplyr)\nparim_tootlus=andmed %>%\n    select(symbol,nimi, tootlus)%>%\n    arrange(desc(tootlus))%>%\n    head(3)\n\nandmed$hind=as.numeric(as.character(andmed$hind))\nandmed2=mutate(andmed, kaive=hind*kogus)\n\nsektori_grupp=group_by(andmed2, sektor)\n\nsektori_loikes <- summarise(sektori_grupp,\n                   keskmine_tootlus=mean(tootlus, na.rm=T),\n                   kogukaive=sum(kaive, na.rm=T),\n                   keskmine_kaive=mean(kaive, na.rm=T),\n                   ettevotete_arv=n())\nsektori_loikes=filter(sektori_loikes, ettevotete_arv>=30)\n#facotierst numericuks\nandmed$kasum_aktsia_kohta=as.numeric(as.character(andmed$kasum_aktsia_kohta))\nandmed$dividend_aktsia_kohta=as.numeric(as.character(andmed$dividend_aktsia_kohta))\n\n\nandmed=mutate(andmed, \n              kasum_aktsiahinna_suhe=kasum_aktsia_kohta/hind,\n              dividendi_maar=dividend_aktsia_kohta/hind)\n\nandmed=mutate(andmed, atraktiivsus_skoor=0.5*kasum_aktsiahinna_suhe+0.5*dividendi_maar)\n\nandmed=arrange(andmed, atraktiivsus_skoor)\n\nandmed2=andmed\nandmed2=filter(andmed2, symbol %in% c(\"AAPL\", \"FB\", \"GOOG\", \"IBM\", \"TSLA\"))\nkauplemisalgoritm(andmed2)\n\n#andmete võtmine yahoo financest\nsymbols=unique(andmed$symbol)\nsymbols=as.character(symbols)\ndata=getQuote(symbols,src = \"yahoo\",\n              what=yahooQF(c(\"Last Trade (Price Only)\",\"Symbol\",\"Volume\", \"Earnings/Share\", \"Dividend/Share\")))\n#algtabelist võtame symoli, nime, sektori ja aktsiate arvu\nandmed_select=select(andmed, symbol, nimi, sektor, aktsiate_arv)\n#väiketähtdeks\nnames(data)=tolower(names(data))\n#mergime kokku\nandmed_merge=merge(andmed_select, data, by=\"symbol\")\n\n#funktsioon, et andmedyahoost tõmmata ja kokku mergida\nandmed_yahoost = function(algfail){\n    library(dplyr)\n    #võtame symbolid, mille kohta infot tõmmata\n    symbols=unique(algfail$symbol)\n    symbols=as.character(symbols)\n    #tõmbame andmed yahoost\n    data=getQuote(symbols,src = \"yahoo\",\n                  what=yahooQF(c(\"Last Trade (Price Only)\",\n                                 \"Symbol\",\"Change in Percent\",\n                                 \"Volume\", \n                                 \"Earnings/Share\", \n                                 \"Dividend/Share\")))\n    #võtame algfailist ainult vajalikud andmed\n    andmed_select=select(algfail, symbol, nimi, sektor, aktsiate_arv)\n    #väiketähtdeks columnite nimed (vaja et kokku mergida)\n    names(data)=tolower(names(data))\n    #mergime kokku\n    andmed_merge=merge(andmed_select, data, by=\"symbol\")\n    andmed_merge\n}\n    \nproov=andmed_yahoost(andmed)\n\nnames(proov)=c(\"symbol\", \"nimi\", \"sektor\",\"aktsiate_arv\", \"trade time\", \"hind\",\n               \"tootlus\", \"kogus\", \"kasum_aktsia_kohta\",\"dividend_aktsia_kohta\")\n\n#puhastame tootluse ära\n\nproov$tootlus=gsub(\"\\\\+\",\"\", proov$tootlus)\nproov$tootlus=gsub(\"\\\\-\",\"\", proov$tootlus)\nproov$tootlus=gsub(\"\\\\%\",\"\", proov$tootlus)\n#teeme numericuks\nproov$tootlus=as.numeric(as.character(proov$tootlus))\n\n",
    "created" : 1430476610478.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3685361060",
    "id" : "2FAB9806",
    "lastKnownWriteTime" : 1430498355,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/Andmeteadus_TU/I praktikum/aktsiad.R",
    "project_path" : "aktsiad.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}