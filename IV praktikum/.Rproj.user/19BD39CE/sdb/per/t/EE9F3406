{
    "contents" : "---\ntitle: \"NBA\"\nauthor: \"Risto Hinno\"\ndate: \"Friday, June 26, 2015\"\noutput: pdf_document\n---\n\nJaanus “Sops” Kolmene käib jõusaalis kolm korda nädalas. Järgmisel kuul sisustab ta ka reede õhtupooliku raskusi tõstes, sest tema rinnalihas on statistiku jaoks liiga nõrk. Nimelt otsib korvpalliklubi Brooklyn Nets oma ridadesse statistikut, kes analüüsiks korvpalliandmeid ja aitaks seeläbi optimiseerida meeskonna mängustrateegiat. Kandidaadi nõuete seas on ka 50 kg rinnalt surumine. 1\n\nKuna rinnalihase nõue on ehk peagi täidetud, tahab Jaanus enne intervjuule minekut saada praktilist kogemust NBA andmete analüüsimisel. Ta teab, et NBA mängude kohta kogutakse SportVU tehnoloogia abil detailset statistikat.\n\n\n##Tutvumine andmestikuga\n\nKasutame NBA 2013/14 hooaja andmeid. Andmestikus on järgnevad tunnused:\n\n- name - korvpalluri nimi\n\n- team_name - korvpalluri meeskonna nimi\n\n- opponent - vastasmeeskonna nimi\n\n- game_date - mängu kuupäev\n\n- shot_made_flag - kas vise läks korvi\n\n- shot_type - kas oli 2-punkti või 3-punkti vise\n\n- x - viske x-koordinaat\n\n- y - viske y-koordinaat\n\nLaadi alla andmestik nba_2013.csv ja loe töökeskkonda.\n\n```{r, cache=TRUE}\nnba=read.csv2(\"./data/nba_2013.csv\")\n\n```\n\n##Ülesanne 1 (1 punkt)\n\nVisualiseeri NBA meeskonna Miami Heat viskekohti hajuvusdiagrammi abil kasutades tunnuseid x ja y. Iga sooritatud vise näita täpikesena. Kasuta R-i baasgraafika funktsiooni plot.\n```{r, cache=TRUE}\nnba_heat=subset(nba, team_name==\"Miami Heat\")\nplot(nba_heat$x, nba_heat$y)\n\n```\n\n##Ülesanne 2 (2 punkti)\n\nDiskretiseeri mänguväljak (jaga mänguväljak tükkideks).\n\nTükid moodusta nii, et ümarda x- ja y-koordinaat kümnelisteni. Iga kastikese kohta arvuta:\n\n- visete arv\n\n- tabavusprotsent\n\nNäpunäited:\n\n- uuri, mida teeb käsk round(21:30, -1).\n\n- kasuks tuleb paketi dplyr funktsionaalsus (mutate, group_by, summarise)\n\n```{r, cache=TRUE, message=FALSE, warning=FALSE}\nnba$x_round=round(nba$x, -1)\nnba$y_round=round(nba$y, -1)\n\nlibrary(dplyr)\nnba2=nba%>%\n    group_by(x_round, y_round)%>%\n    mutate(count = n(),\n           tabavusprotsent=sum(shot_made_flag)/count)\n\n```\n\n##Ülesanne 3 (2 punkti)\n\nVisualiseeri eelmise ülesande tulemusena saadud andmeid. Tee kaks joonist:\n\n- Iga diskretiseeritud kastikese kohta joonista ring. Ringi pindala olgu proportsionaalne visete arvuga.\n\n- Iga diskretiseeritud kastikese kohta joonista ruut. Ruudu pindala olgu proportsionaalne visete arvuga.\n\nNäpunäited:\n\n- Esmalt tekita tühi aken, kuhu hakkame joonistama: plot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\n\n- Ringikesed kanna joonisele funktsiooni symbols abil.\n\n- Kuigi symbols töötab ka vektoritega, on edasise huvides lihtsam kasutada for tsüklit ning kanda ringid/ruudud joonisele ükshaaval.\n\n- Funksiooni symbols korral on kasulikud argumendid inches=FALSE, add=TRUE. Esimene neist on vajalik selleks, et sümboli suurus skaleeruks vastavalt etteantud raadiusele, add=TRUE selleks, et viimati tehtud joonisele lisada uus sümbol.\n\n\n```{r, cache=TRUE}\nnba2_heat=subset(nba2, team_name==\"Miami Heat\")\n\nplot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\n#symbols(200, 100,circles=2,inches=FALSE, add=TRUE)\nfor (i in length(nba2_heat)) {\n    symbols(nba2_heat$x_round, nba2_heat$y_round,circles=nba2_heat$count,\n            inches=FALSE, add=TRUE)\n}\n#kasutame points käsku\nplot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\nfor (i in length(nba2)) {\n    points(nba2$x_round, nba2$y_round, cex=nba2$count)\n}\n\n#sama asi ruutudega\nplot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\nfor (i in length(nba2)) {\n    points(nba2$x_round, nba2$y_round, cex=nba2$count, pch=22)\n}\n#kasutame symbols käsku\nplot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\nfor (i in length(nba2)) {\n    symbols(nba2$x_round, nba2$y_round,squares=nba2$count,\n            inches=F, add=TRUE, fg=\"grey\")\n}\n```\n\n\n##Ülesanne 4 - suuruse muutmine (2 punkti)\n\nNäeme, et meie joonisel on korvialuste kastikeste pindala palju suurem kui NY Timesi joonisel. NY Timesi graafikaosakond on jaganud visete arvu kolme kategooriasse: low, medium, high. Mida arvad, kas on hea mõte jagada kastid kolme kategooriasse?\n\na.) Vali välja piirid, mille põhjal jaotatakse visete arv kolme kategooriasse (low, medium, high). Iga kategooria jaoks vali sobiv pindala suurus (kontrolli, et tulemus oleks visuaalselt kena). Kirjuta funktsioon get_radius, mis visete arvu sisestamisel tagastab vastava kategooria raadiuse.\n\nb.) Visualiseeri nüüd viskepositsioone sarnaselt eelmisele ülesandele, kui ringidel/ruutudel on vaid 3 erinevat suurust.\n\n```{r, cache=TRUE}\nget_radius = function(visete_arv){\n    tulem=list()\n    for (i in 1:length(visete_arv)) {\n    if (visete_arv[i]<150) {tulem[i]=2}\n     else if(visete_arv[i]<=1000) {tulem[i]=4}\n        else if (visete_arv[i]>1000) {tulem[i]=6}\n    }\n    tulem\n}\n\nnba2_heat$count_grupp=get_radius(nba2_heat$count)\n#visualiseerime\nplot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\n#symbols(200, 150,circles=10,inches=FALSE, add=TRUE)\nfor (i in length(nba2_heat)) {\n    symbols(nba2_heat$x_round, nba2_heat$y_round,circles=nba2_heat$count_grupp,\n            inches=FALSE, add=TRUE)\n}\n\n```\n\n##Ülesanne 5 - värvid (2 punkti)\n\nUuri, mida tähistavad NY Times’i graafikul punane ja roheline värv.\n\nLisa nüüd ruutudele/ringidele värv vastavalt visketabavusele. Selleks kirjuta esmalt funktsioon get_color, mis tagastab antud visketabamusele vastava värvikoodi.\n\n```{r, cache=TRUE}\npal = colorRampPalette(c(\"#A6CD95\", \"#F1E471\", \"#ED6751\"))\n# colorRampPalette tagastab funktsiooni, mis võtab sisendiks täisarvu ja \n#väljastab vastava arvu värve\ncolors = pal(100)\n# näide\npie(1:5, col=colors[c(1, 25, 50, 75, 100)])\npie(1:5, col=colors[c(1, 1.2, 2, 75, 100)])\n#teeme täisarvuks tabavusprotsendi\nnba2_heat$tabavusprotsent2=round(nba2_heat$tabavusprotsent*100)\n#asendame nullid 1-ga, muidu ei anna colorit\nnba2_heat$tabavusprotsent3=ifelse(nba2_heat$tabavusprotsent2==0 ,1,\n                                  nba2_heat$tabavusprotsent2)\n#teeme funktsiooni värvide arvutamiseks\nget_color = function(visketabamus){\n    pal = colorRampPalette(c(\"#A6CD95\", \"#F1E471\", \"#ED6751\"))\n    colors = pal(100)\n    varv=colors[visketabamus]\n}\n#arvutame väärtused\nnba2_heat$color=get_color(nba2_heat$tabavusprotsent3)\n\n#paneme plotile\nplot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\nfor (i in length(nba2_heat)) {\n    symbols(nba2_heat$x_round, nba2_heat$y_round,circles=nba2_heat$count_grupp,\n            inches=FALSE, add=TRUE, bg=nba2_heat$color, fg=nba2_heat$color)\n}\n\n```\n\n##Ülesanne 6 - kuusnurgad (2 punkti)\n\nKasuta nüüd ringide ja ruutude asemel kuusnurki. Oleme ette andnud funktsiooni plot_hexagon, mis sisestades keskpunkti koordinaadid ja pindala, joonistab kuusnurga.\n\n```{r, cache=TRUE}\nplot_hexagon = function(x, y, area, col=\"red\", ...){\n    r = sqrt(2*sqrt(3)/9*area)\n    x_id = x + c(0, sqrt(3)/2*r, sqrt(3)/2*r, 0, -sqrt(3)/2*r, -sqrt(3)/2*r) \n    y_id = y + c(r, r/2, -r/2, -r, -r/2, r/2)\n    polygon(x_id, y_id, col=col, ...)  \n}\n#näide\nplot(0, 0, type = \"n\", axes = FALSE, xlim=c(-5, 5), \n     ylim=c(-5, 5), xlab=\"\", ylab= \"\", asp=1)\nplot_hexagon(1, 1, 15)\nplot_hexagon(3, 3, 15, col=\"blue\", border=\"white\")\n\n#teeme reaalsete andmetega\n#enne teeme numericuks\nnba2_heat$count_grupp=as.numeric(nba2_heat$count_grupp)\n#teeme countgrupi suuremaks, et paistaks välja plotilt\nget_radius_hexagon = function(visete_arv){\n    tulem=list()\n    for (i in 1:length(visete_arv)) {\n        if (visete_arv[i]<150) {tulem[i]=500}\n        else if(visete_arv[i]<=1000) {tulem[i]=600}\n        else if (visete_arv[i]>1000) {tulem[i]=700}\n    }\n    tulem\n}\nnba2_heat$count_grupp_hex=get_radius_hexagon(nba2_heat$count)\nnba2_heat$count_grupp_hex=as.numeric(nba2_heat$count_grupp_hex)\n\n#plotime, kuid millegipärast kuvab ainult osad kuusnurgad\nplot(0, 0, type = \"n\", xlim=c(-250, 250), ylim=c(0, 400))\nfor (i in 1:length(nba2_heat)) {\n    plot_hexagon(x=nba2_heat$x_round[i], y=nba2_heat$y_round[i], \n                 area=nba2_heat$count_grupp_hex[i], \n                 col=nba2_heat$color[i], border=\"white\")    \n}\n\n```\n",
    "created" : 1435347947562.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3846585051",
    "id" : "EE9F3406",
    "lastKnownWriteTime" : 1435400399,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/Andmeteadus_TU/IV praktikum/praktikum4_NBA_pdf.Rmd",
    "project_path" : "praktikum4_NBA_pdf.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}