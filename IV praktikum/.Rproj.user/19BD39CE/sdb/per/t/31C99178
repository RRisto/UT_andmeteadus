{
    "contents" : "---\ntitle: \"Lennuliiklus\"\nauthor: \"Risto Hinno\"\ndate: \"Friday, June 26, 2015\"\noutput: pdf_document\n---\n\n\n##Tutvumine andmestikuga\n\nLaadi alla andmestikud airports.csv ja flights.csv ning loe need töökeskkonda.\n\nAndmestikus airports.csv on informatsioon lennujaamade kohta. Selles on järgnevad tunnused:\n\n- id - lennujaama id\n\n- name - lennujaama nimi\n\n- city - millises linnas asub lennujaam\n\n- country - millises riigis asub lennujaam\n\n- lat - lennujaama asukoha laiuskraad\n\n- lon - lennujaama asukoha pikkuskraad\n\nAndmestik flights.csv sisaldab infot lendude kohta. Selles on järgnevad tunnused:\n\n- airline - lennukompanii lühend\n\n- airline_id - lennukompanii id\n\n- source_airport - lähtekoha lennujaama lühend\n\n- source_airport_id - lähtekoha lennujaama lühend\n\n- dest_airport - sihtkoha lennujaama lühend\n\n- dest_airport_id - sithkoha lennujaama id\n```{r, cache=TRUE}\nairports=read.csv(\"./data/airports.csv\")\nairports_alg=airports\nflights=read.csv(\"./data/flights.csv\")\n\n```\n\n\n##Suurringjoon\n\nPaul Butler kasutas suurringjooni, et visualiseerida ühendusi sõprade vahel. Kahe punkti lühim vahemaa keral avaldub suurringjoone kaudu. Kui tuult ja muid sarnaseid tegureid mitte arvestada, lendavad lennukid pikki vahemaid suurringjoonte marsruutide kaudu.\n\nNäide, kuidas joonistada suurringjoont R-is. Ühendame Liivi 2 maja Facebooki peakontoriga.\n\n\n```{r, cache=TRUE}\nlibrary(maps)\nlibrary(geosphere)\n\nmap(\"world\", col=\"#f2f2f2\", fill=TRUE, border=NA)\n\nlat_liivi = 58.379491\nlon_liivi = 26.713199\nlat_fb = 37.485245\nlon_fb = -122.148807\n\ngc_points = gcIntermediate(c(lon_liivi, lat_liivi), c(lon_fb, lat_fb), n=50, addStartEnd=TRUE)\nlines(gc_points)\n\n```\n\n##Ülesanne 1 (5 punkti)\n\nVisualiseeri suurringjoonte abil ühendusi, kuhu saab Tallinna lennujaamast otselennuga.\n\nNäpunäited:\n\n- Kuna otselennuga saab Tallinnast vaid Euroopasse, siis kanna joonisele vaid Euroopa kaart. Selleks uuri, kuidas map funktioonile ette anda koordinaate. Kasuta xlim = c(-10, 40), ylim = c(30, 70).\n\n- Tallinna lennujaama kood on 415 (mille võid leida, kui uurid andmestikust airports Eesti lennujaamu).\n\n- Sihtkohtade lennujaamad leiad andmestikust flights.csv.\n\n- Lennujaamade koordinaadid leiad andmestikus airports.csv.\n\n```{r, cache=TRUE}\nallikas=airports[, c(\"id\", \"lat\", \"lon\")]\nnames(allikas)=c(\"id\", \"source_airport_lat\", \"source_airport_lon\")\ndata=merge(flights, allikas, by.x=\"source_airport_id\", by.y=\"id\", all.x=T, all.y=F)\nnames(allikas)=c(\"id\", \"dest_airport_lat\", \"dest_airport_lon\")\ndata=merge(data, allikas, by.x=\"dest_airport_id\", by.y=\"id\", all.x=T, all.y=F)\n#teeme subseti ainult neist andmetest, kus alguspunkt on tallinn\ndata2=subset(data, source_airport_id==415)\n#teeme kaardi\nmap(xlim = c(-10, 40), ylim = c(30, 70),col=\"#f2f2f2\", fill=TRUE, border=NA)\n#itereerime punktid peale\nfor (i in 1:nrow(data2)) {\n    points = gcIntermediate(c(data2$source_airport_lon[i], \n                              data2$source_airport_lat[i]),\n                               c(data2$dest_airport_lon[i], \n                                 data2$dest_airport_lat[i]), n=50, \n                               addStartEnd=TRUE)\n    lines(points)\n}\n\n```\n\n##Ülesanne 2 (9 punkti)\n\nVisualiseeri ühendusi, kuhu saab Tallinna lennujaamast otselennu või ühe vahepeatusega.\n\nNäpunäited:\n\n- Et värve muuta läbipaistvaks, lisa värvikoodile lõppu läbipaistvuse intensiivsus. Näiteks kasuta funktsiooni lines korral argumenti col=\"#00000010\", et muuta mustade (värvikood #000000) joonte läbipaistvus 10%-ni.\n\n- Visualiseeri ühendusi Tallinn - vahelennujaam - lõpp-punkt. Tingimata pole tarvis mitu korda joonistada Tallinn - vahelennujaam ühendusi, need võid joonistada ka ühe korra.\n\n```{r, cache=TRUE}\nairports=unique(data2$dest_airport_id)\ndata3=subset(data, source_airport_id==415| source_airport_id %in% airports)\n#teeme mapi\nmap(\"world\",col=\"#c7e9c090\", fill=TRUE, border=NA,mar = c(1, 1, par(\"mar\")[3], 0.1))\n#itereerime punktid peale\n#Et värve muuta läbipaistvaks, lisa värvikoodile lõppu läbipaistvuse intensiivsus.\n#Näiteks kasuta funktsiooni lines korral argumenti col=\"#00000010\", et muuta \n#mustade (värvikood #000000) joonte läbipaistvus 10%-ni.\nfor (i in 1:nrow(data3)) {\n    points = gcIntermediate(c(data3$source_airport_lon[i], \n                              data3$source_airport_lat[i]),\n                            c(data3$dest_airport_lon[i], \n                              data3$dest_airport_lat[i]), n=50, \n                            addStartEnd=TRUE)\n    lines(points, col=\"#00000008\")\n}\n```\n\n##Boonusülesanne 1 (1 punkt) - Juhuslik ekslemine eralennukiga\n\nAlusta Tallinna lennujaamast. Vali kõikvõimalikest lennujaamadest juhuslikult üks ja lenda sinna. Vali nüüd juhuslikult järgmine sihtpunkt ning lenda sinna. Jätka seda protsessi 100 korral ja visualiseeri läbitud teekonda.\n\n```{r, cache=TRUE}\nmap(\"world\",col=\"#c7e9c090\", fill=TRUE, border=NA,mar = c(1, 1, par(\"mar\")[3], 0.1))\n\n#teeme alguse ära, tallinnast esimene liin\ndata_subset=subset(data, source_airport_id==415)\ndestination=sample(data_subset$dest_airport_id,1)\ndata_subset=subset(data_subset, source_airport_id==415&\n                       dest_airport_id==destination )[1,] #võtame esimese rea\n#kuna võib olla mitu liini ühte kohta samast lennujaamast\n\npoint=gcIntermediate(c(data_subset$source_airport_lon, \n                       data_subset$source_airport_lat),\n                     c(data_subset$dest_airport_lon, \n                       data_subset$dest_airport_lat), n=50, \n                     addStartEnd=TRUE)\nlines(point, col=\"#00000050\")\n\n```\n\n```{r}\n\n#kordame 100 korda\nlibrary(maps)\nlibrary(geosphere)\nmap(\"world\",col=\"#c7e9c090\", fill=TRUE, border=NA,mar = c(1, 1, par(\"mar\")[3], 0.1))\n#teeme alguse ära, tallinnast esimene liin\ndata_subset=subset(data, source_airport_id==415)\ndestination=sample(data_subset$dest_airport_id,1)\ndata_subset=subset(data_subset, source_airport_id==415&\n                       dest_airport_id==destination )[1,] #võtame esimese rea\n#kuna võib olla mitu liini ühte kohta samast lennujaamast\n\npoint=gcIntermediate(c(data_subset$source_airport_lon, \n                       data_subset$source_airport_lat),\n                     c(data_subset$dest_airport_lon, \n                       data_subset$dest_airport_lat), n=50, \n                     addStartEnd=TRUE)\nlines(point, col=\"#00000050\")\nfor (i in 1:100) {\n    data_subset=subset(data, source_airport_id==destination)\n    destination=sample(data_subset$dest_airport_id,1)\n    data_subset=subset(data_subset, dest_airport_id==destination )[1,]\n    points=gcIntermediate(c(data_subset$source_airport_lon, \n                           data_subset$source_airport_lat),\n                         c(data_subset$dest_airport_lon, \n                           data_subset$dest_airport_lat), n=50, \n                         addStartEnd=TRUE)\n    lines(points, col=\"#00000050\")  \n}\n```\n\n##Boonusülesanne 2 (2 punkti) - Juhuslik ekslemine kasutades kommertsliine\n\nAlusta Tallinna lennujaamast. Vali võimalikest sihtkohtadest üks ja lenda sinna. Vali selle lennujaama võimalikest sihtkohtadest juhuslikult järgmine ning lenda sinna. Jätka seda protsessi 100 korral ja visualiseeri läbitud teekonda.\n\n```{r}\nmap(\"world\",col=\"#c7e9c090\", fill=TRUE, border=NA,mar = c(1, 1, par(\"mar\")[3], 0.1))\n\nalg=subset(airports_alg, id==415)\nsamp=sample(airports_alg$id, 1)\ndest=subset(airports_alg, id==samp)\npoint=gcIntermediate(c(alg$lon, \n                       alg$lat),\n                     c(dest$lon, \n                       dest$lat), n=50, \n                     addStartEnd=TRUE)\nlines(point, col=\"#00000050\")\n\nfor (i in 1:100) {\n    samp1=sample(airports_alg$id,1)\n    alg=subset(airports_alg, id==samp1)\n    samp2=sample(airports_alg$id,1)\n    dest=subset(airports_alg, id==samp2)\n    point=gcIntermediate(c(alg$lon, \n                           alg$lat),\n                         c(dest$lon, \n                           dest$lat), n=50, \n                         addStartEnd=TRUE)\n    lines(point, col=\"#00000050\")\n}\n\n```\n",
    "created" : 1435348306467.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1809486420",
    "id" : "31C99178",
    "lastKnownWriteTime" : 1435348359,
    "path" : "~/Minu asjad/Statistika, mudelid, excel/R/Andmeteadus_TU/IV praktikum/praktikum4_lennuliiklus_pdf.Rmd",
    "project_path" : "praktikum4_lennuliiklus_pdf.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}